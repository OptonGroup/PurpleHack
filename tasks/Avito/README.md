## Описание задачи

Необходимо построить алгоритм, который по фотографии товара определяет его основной цвет из 18 возможных. Товары относятся к 4 категориям:  
- **одежда для девочек**,  
- **столы**,  
- **стулья**,  
- **сумки**.  

Категории могут влиять на сложность распознавания цвета. Например, сумки часто бывают многоцветными.

---

## Актуальность

На площадке Avito пользователи часто ищут товары по цвету. Если модель неправильно определяет цвет или пропускает товары нужного цвета, покупатели не смогут найти подходящие товары. Поэтому важно:  
- **максимизировать Recall** (не пропускать товары),  
- **увеличивать Precision** (уменьшать ложные срабатывания).  

---

## Цвета (Target)

18 классов:  
бежевый, белый, бирюзовый, бордовый, голубой, жёлтый, зелёный, золотой, коричневый, красный, оранжевый, разноцветный, розовый, серебристый, серый, синий, фиолетовый, чёрный.

---

## Данные

### Обучающая выборка:
- **train_data.zip** – архив с изображениями.  
- **train_data.csv** – файл с метаданными:  
  - `id` – уникальный идентификатор изображения,  
  - `category` – категория товара,  
  - `target` – истинный цвет.  

### Тестовая выборка:
- **test_data.zip** – архив с изображениями.  
- **test_data.csv** – файл с метаданными:  
  - `id` – уникальный идентификатор изображения,  
  - `category` – категория товара.  

[Ссылка на dataset](https://disk.yandex.ru/d/8cdudaiwb7DyUA)

---

## Метрики

- **Recall (macro)** – доля правильно найденных объектов каждого цвета.  
- **Precision (macro)** – доля верных предсказаний среди всех предсказанных объектов каждого цвета.  
- **Accuracy** – доля верных ответов среди всех примеров.  
- **F1 (macro)** – гармоническое среднее Precision и Recall, усреднённое по всем цветам.  

---

## Формат ответа

Необходимо сгенерировать файл **submission.csv** со следующими колонками:  
- `id` – идентификатор изображения (как в test_data.csv),  
- `category` – категория товара,  
- `predict_proba` – словарь в формате JSON-строки с вероятностями для каждого из 18 цветов,  
- `predict_color` – цвет с максимальной вероятностью.  

### Пример:


| id           | category | predict_proba                                      | predict_color |
|--------------|----------|----------------------------------------------------|---------------|
| 36490520922  | сумки    | { "белый": 0.8, "черный": 0.1, "красный": 0.1 }    | белый         |
| 36506736022  | столы    | { "зеленый": 0.7, "синий": 0.2, "черный": 0.1 }    | зеленый       |