# Прогресс разработки планировщика размещения виртуальных машин MTS Cloud Platform

## Описание проекта

Разработка планировщика для оптимального распределения виртуальных машин (ВМ) по физическим серверам (хостам) в дата-центрах MTS Cloud Platform.

### Ключевые цели

- Минимизация количества включенных хостов
- Поддержание оптимальной утилизации (~80%)
- Обеспечение стабильности работы инфраструктуры

## Текущий статус разработки

### Завершенные задачи

- [X]  Создана тестовая инфраструктура
- [X]  Разработаны тестовые наборы данных
- [X]  Реализована система тестирования
- [X]  Внедрена система оценки результатов

### В процессе

- [ ]  Реализация алгоритма размещения ВМ
- [ ]  Оптимизация производительности
- [ ]  Подготовка Docker-образа

## Тестовая инфраструктура

### 1. Наборы тестовых данных

#### 1.1 Базовое тестирование (basic_placement)

- Проверка базового функционала размещения ВМ
- 3 раунда с постепенным добавлением ВМ
- Валидация корректности базового размещения

#### 1.2 Тестирование отказов (allocation_failure)

- Проверка обработки невозможности размещения
- Тестирование граничных случаев с большими ВМ
- Валидация корректности обработки ошибок

#### 1.3 Тестирование оптимальной утилизации (optimal_utilization)

- Проверка достижения целевой утилизации 80%
- Тестирование балансировки нагрузки
- Оценка эффективности размещения

#### 1.4 Тестирование миграций (migration_test)

- Проверка механизма миграции ВМ
- Оценка эффективности перераспределения
- Валидация корректности миграций

#### 1.5 Тестирование удаления ВМ (vm_removal_test)

- Проверка корректности удаления ВМ
- Тестирование бонусов за выключение хостов
- 5 раундов последовательного удаления

#### 1.6 Тестирование масштабируемости (large_scale_test)

- Проверка работы с большими наборами данных
- Тестирование производительности
- Оценка времени выполнения

#### 1.7 Тестирование разнородных хостов (heterogeneous_hosts)

- Проверка работы с разными конфигурациями
- Оценка эффективности размещения
- Тестирование балансировки

#### 1.8 Тестирование граничных случаев (edge_cases)

- Проверка экстремальных сценариев
- Тестирование устойчивости решения
- Валидация обработки ошибок

### 2. Система тестирования (test_runner.py)

#### 2.1 Основной функционал

- Автоматический запуск тестов
- Измерение времени выполнения
- Контроль потребления памяти
- Проверка ограничений (2 секунды/раунд)

#### 2.2 Система оценки

- Реализация формулы расчёта баллов:

```
f(x) = -0.67466 + (42.385/(-2.5x+5.96)) * exp(-2*ln(-2.5x+2.96))
```

- Учёт штрафов:
  - За невозможность размещения: -5×h баллов
  - За миграцию: -m² баллов
- Учёт бонусов за выключение хостов: +8 баллов

#### 2.3 Валидация результатов

- Проверка корректности размещения
- Контроль ресурсных ограничений
- Валидация миграций
- Проверка уникальности размещения

#### 2.4 Система отчётности

- Детальная статистика по тестам
- Метрики производительности
- Общий рейтинг решения
- Рекомендации по оптимизации

## Следующие шаги

### Краткосрочные задачи

1. Реализация базового алгоритма размещения ВМ
2. Внедрение логики миграций
3. Тестирование производительности

### Среднесрочные задачи

1. Оптимизация алгоритмов
2. Улучшение системы балансировки
3. Расширение тестового покрытия

### Долгосрочные задачи

1. Подготовка Docker-образа
2. Документирование решения
3. Финальное тестирование

## Технические требования

### Ограничения

- Время выполнения: максимум 2 секунды
- Память: минимально возможное потребление
- Ядро Linux: 6.6+

### Поддерживаемые платформы

- linux/arm64/v8 (Apple M1 Pro)
- linux/amd64 (AMD Ryzen 7 3500U)

### Зависимости

- Python 3.9-3.13
- Docker 26.x (опционально)

## заметки

- Идея 1: ...
- Идея 2: ...
